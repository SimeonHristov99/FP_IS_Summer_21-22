main :: IO()
main = do
   print $ (sumExpr (2+) [0, 1, 2, 3]) 2 == 80
   print $ (sumExpr (*0.8) [0, 1, 2, 3, 4, 5]) 10 == 4345680.0

sumExpr :: (Num a) => (a -> a) -> [a] -> (a -> a)
sumExpr f ys = (\ x -> sum [ y * f (x^i) | (y, i) <- zip ys [1 ..] ])
               -- (\ x y z -> body)

-- (sumExpr f=(2+) ys=[0, 1, 2, 3]) x=2
-- sum [ y * f (x^i) | (y, i) <- zip [0, 1, 2, 3] [1 ..] ]
-- sum [ y * f (x^i) | (y, i) <- [(0, 1), (1, 2), (2, 3), (3, 4)] ]
-- sum [ 0 * f (2^1) | (y=0, i=1) <- [(1, 2), (2, 3), (3, 4)] ]
-- sum [ 0 * 2 + 2 | (y=0, i=1) <- [(1, 2), (2, 3), (3, 4)] ]
-- sum [ 0 * 4 | (y=0, i=1) <- [(1, 2), (2, 3), (3, 4)] ]
-- sum [ 0 | (y=0, i=1) <- [(1, 2), (2, 3), (3, 4)] ]
-- sum [ 1 * f (2^2) | (y=1, i=2) <- [(2, 3), (3, 4)] ]
-- sum [ 1 * f 4 | (y=1, i=2) <- [(2, 3), (3, 4)] ]
-- sum [ 1 * 6 | (y=1, i=2) <- [(2, 3), (3, 4)] ]
-- sum [ 6 | (y=1, i=2) <- [(2, 3), (3, 4)] ]